import { D as DIRECTUS_URL, a as DIRECTUS_TOKEN } from './private-027d6d73.js';

var g=e=>({url:new URL(e),with(t){return {...this,...t(this)}}});var h=async(e,t,r)=>{t.headers=typeof t.headers=="object"&&!Array.isArray(t.headers)?t.headers:{};let a=r??(s=>typeof s=="object"&&s&&"data"in s?s.data:s),m=await globalThis.fetch(e,t).then(async s=>{let i=s.headers.get("Content-Type")?.toLowerCase();if(i?.startsWith("application/json")){let c=await s.json();if(!s.ok)throw c;return c}if(i?.startsWith("text/html")||i?.startsWith("text/plain")){let c=await s.text();if(!s.ok)throw c;return c}}).catch(s=>{throw s});return a(m)};var Te=(e,t,r)=>()=>{let o=String(e);if(o.startsWith("directus_"))throw new Error("Cannot use createItem for core collections");return {path:`/items/${o}`,params:r??{},body:JSON.stringify(t),method:"POST"}};var ho=(e,t)=>()=>{let r=String(e);if(r.startsWith("directus_"))throw new Error("Cannot use readItems for core collections");return {path:`/items/${r}`,params:t??{},method:"GET"}};var fc=(e={})=>t=>({async request(r){let o=r();if(o.headers||(o.headers={}),"Content-Type"in o.headers?o.headers["Content-Type"]==="multipart/form-data"&&delete o.headers["Content-Type"]:o.headers["Content-Type"]="application/json","getToken"in this){let c=await this.getToken();c&&(o.headers||(o.headers={}),o.headers.Authorization=`Bearer ${c}`);}let a=u(t.url,o.path,o.params),m={method:o.method??"GET",headers:o.headers??{}};o.body&&(m.body=o.body),o.onRequest&&(m=await o.onRequest(m)),e.onRequest&&(m=await e.onRequest(m));let s;return e.onResponse&&o.onResponse?s=c=>Promise.resolve(c).then(e.onResponse).then(o.onResponse):"onResponse"in o?s=o.onResponse:"onResponse"in e&&(s=e.onResponse),await h(a.toString(),m,s)}});var R=e=>{let t={};if(Array.isArray(e.fields)&&e.fields.length>0){let r=(o,a=[])=>{if(typeof o=="object"){let m=[];for(let s in o){let i=o[s]??[];if(Array.isArray(i))for(let c of i)m.push(r(c,[...a,s]));else if(typeof i=="object")for(let c of Object.keys(i)){let S=i[c];for(let f of S)m.push(r(f,[...a,`${s}:${c}`]));}}return m.flatMap(s=>s)}return [...a,String(o)].join(".")};t.fields=e.fields.flatMap(o=>r(o)).join(",");}return e.filter&&Object.keys(e.filter).length>0&&(t.filter=JSON.stringify(e.filter)),e.search&&(t.search=e.search),"sort"in e&&e.sort&&(t.sort=typeof e.sort=="string"?e.sort:e.sort.join(",")),typeof e.limit=="number"&&e.limit>=-1&&(t.limit=String(e.limit)),typeof e.offset=="number"&&e.offset>=0&&(t.offset=String(e.offset)),typeof e.page=="number"&&e.page>=1&&(t.page=String(e.page)),e.deep&&Object.keys(e.deep).length>0&&(t.deep=JSON.stringify(e.deep)),e.alias&&Object.keys(e.alias).length>0&&(t.alias=JSON.stringify(e.alias)),e.aggregate&&Object.keys(e.aggregate).length>0&&(t.aggregate=JSON.stringify(e.aggregate)),e.groupBy&&e.groupBy.length>0&&(t.groupBy=e.groupBy.join(",")),t};var x="/",O=(e,t)=>(e.endsWith(x)&&(e=e.slice(0,-1)),t.startsWith(x)||(t=x+t),e+t),u=(e,t,r)=>{let o=e.pathname===x?t:O(e.pathname,t),a=new globalThis.URL(o,e);if(r)for(let[m,s]of Object.entries(R(r)))if(s&&typeof s=="object"&&!Array.isArray(s))for(let[i,c]of Object.entries(s))a.searchParams.set(`${m}[${i}]`,String(c));else a.searchParams.set(m,s);return a};var li=e=>t=>{let r=e??null;return {async getToken(){return r},setToken(o){r=o;}}};

const directus = g(DIRECTUS_URL).with(li()).with(fc());
function getDirectusClient() {
  directus.setToken(DIRECTUS_TOKEN);
  return directus;
}

export { Te as T, getDirectusClient as g, ho as h };
//# sourceMappingURL=dir-client-7bb88847.js.map
